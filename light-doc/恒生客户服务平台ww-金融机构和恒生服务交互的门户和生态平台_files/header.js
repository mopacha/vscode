/*!2020-07-08 */
require(["domReady!","avalon","jquery","common/common","jquery.cookie","jquery.actual"],function(a,b,c,d){function e(){var a=d.isLogin();""!=a?(c.ajax({url:window.LOCAL_CONFIG.userCenter+"/CASLoginAPI.do",dataType:"json",contentType:"application/json;charset=UTF-8",type:"post",async:!1,xhrFields:{withCredentials:!0},crossDomain:!0,success:function(a){200==a.status&&a.responseText.indexOf("false")>-1&&(window.location.href=window.userCenterUrl.logoutUrl)},failure:function(a){},complete:function(a){200==a.status&&a.responseText.indexOf("false")>-1&&(window.location.href=window.userCenterUrl.logoutUrl)}}),h.toggleLogin(!0),h.username=a,d.ajax({url:"user/islogin.json",dataType:"json",type:"post",callback:function(a){2==a.userType?h.isCompany=!0:h.isCompany=!1,c("#cas_logout_url").attr("datahref",a.cas_logout_url)},failure:function(a){"291"==a.error_code?(c.cookie("_u_",window.location,{path:"/",expires:10}),window.location.href="/login/login.html"):d.alertNodePop(a.error_info)}})):(h.toggleLogin(!1),g())}function f(){d.ajax({url:"user/islogin.json",dataType:"json",type:"post",callback:function(a){if(0==a)return void h.toggleLogin(!1);h.toggleLogin(!0);var b="";if(a.nikeName){if(b=c.trim(a.nikeName),/^1[3|4|5|7|8]\d{9}$/.test(b)||/^[^\s]*@[\w-]+(\.[\w-]+)+$/.test(b)){var d=b.substring(0,3),e=b.substring(b.length-4,b.length);b=d+"****"+e}}else{b=a.hsid;var d=b.substring(0,3),e=b.substring(b.length-4,b.length);b=d+"****"+e}h.username=b,2==a.userType?h.isCompany=!0:h.isCompany=!1,c("#cas_logout_url").attr("datahref",a.cas_logout_url)},failure:function(a){"291"==a.error_code?(c.cookie("_u_",window.location,{path:"/",expires:10}),window.location.href="/login/login.html"):d.alertNodePop(a.error_info)}})}function g(){var a=document.getElementsByTagName("head")[0],b=document.createElement("script"),c=Math.random();b.type="text/javascript",b.onload=b.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(f(),b.onload=b.onreadystatechange=null)},b.async=!0,b.src=location.protocol+"//"+location.host+"/open/dest/login/sign_H5!.js?v=."+c,a.appendChild(b)}var h=b.define({$id:"header",isCompany:!0,username:"",deal_status:"",left:"",search_doc:"",hotSearchList:[],defaultWords:[],searchBar:!1,trackObj:{10:"注册",11:"登录",12:"搜索",13:"最新活动",14:"产品服务",15:"解决方案",16:"服务市场",22:"LIGHT云Logo"},login:function(){c.cookie("_u_",window.location,{path:"/",expires:10});var a=window.location.href;d.ajax({url:"user/setUserBehavior.json",type:"get",data:{userBehavior:a},callback:function(a){window.location.href="/login/login.html"}})},logOutEvent:function(){c.ajax({url:"/openplat-gateway/openplat/openplat-auth-server/v/logout",type:"post",beforeSend:function(a){a.setRequestHeader("Access-Token",localStorage.getItem("Access-Token"))},dataType:"json",contentType:"application/json;charset=UTF-8",success:function(a){},failure:function(a){}}),window.location.href=c("#cas_logout_url").attr("datahref")},header_track:function(a){},ubasClick:function(a,b){c("#service_name").text()&&(a.c_prodname=c("service_name_ubas").html()),a.c_pagetitle=c("title").html(),Countly.q.push(["customEvent",{eventId:"vid_nav_"+b,other:a}]),window._hmt&&window._hmt.push(["_trackEvent","公共导航","点击",h.trackObj[b]])},regist:function(){var a=window.location.href;d.ajax({url:"user/setUserBehavior.json",type:"get",data:{userBehavior:a},callback:function(a){window.location.href="/registration/regist.html"}})},logout:function(){d.ajax({url:"user/loginExit.json",type:"get",data:"",callback:function(a){h.toggleLogin(!1),c.cookie("_t_","",{path:"/",expires:-1}),c.cookie("_n_","",{path:"/",expires:-1}),c.cookie("_u_",window.location,{path:"/",expires:10}),window.location.href="/login/login.html",c.ajax({url:"/openplat-gateway/openplat/openplat-auth-server/v/logout",type:"post",dataType:"json",contentType:"application/json;charset=UTF-8",success:function(a){},failure:function(a){}})}})},isHaveService:function(){d.ajax({url:"api/queryServiceInfo.json",dataType:"json",type:"post",data:{pageSize:10,currentPage:1,category:0},callback:function(a){null!=a&&(0==a.pageBean.totalItem?window.location.href="/manage/usingService":window.location.href="/manage/serviceManage")},failure:function(a){"404291"==a.error_code?(c.cookie("_u_",window.location,{path:"/",expires:10}),window.location.href="/login/login.html"):d.alertNodePop(a.error_info)}})},toggleLogin:function(a){a?(c("#login").show(),c("#unlogin").hide()):(c("#unlogin").show(),c("#login").hide())},toggleClass:function(a){a.stopPropagation();var b=c(this).find("div");b.hasClass("none_select")?(b.removeClass("none_select").addClass("show_select"),c(this).removeClass("user-close").addClass("user-open")):(b.removeClass("show_select").addClass("none_select"),c(this).removeClass("user-open").addClass("user-close"))},searchDoc:function(){h.search_doc=c.trim(h.search_doc),""!=h.search_doc?window.location.href="/result.html?content="+encodeURIComponent(h.search_doc):d.tips("搜索关键字不能为空，请输入您感兴趣的关键字！")},submitQuery:function(a){a=a||event;var b=a.keyCode?a.keyCode:a.which;if(h.search_doc=c.trim(h.search_doc),"13"==b&&""!=h.search_doc&&(window.location.href="/result.html?content="+encodeURIComponent(h.search_doc)),"13"==b&&""==h.search_doc){var d=c(".searchBar-show .search-wrapper input").attr("placeholder");window.location.href="/result.html?content="+encodeURIComponent(d)}},hover_menu:function(a,b,d,e){if("a"==b){c(".header-line").css("left",0);var f=c(a).position().left,g=c(a).css("width");c(".header-line").addClass("header-line-show"),c(".header-line").css("left",f),c(".header-line").css("width",g),setTimeout(function(){if(!e)return c(".header-drop-wrapper").hide(),!1;d=c(a).attr("childnode");var b=c(".header-drop-wrapper")[d],f=c(a).offset().left;c(b).show().siblings(".header-drop-wrapper").hide(),0!=d&&c(b).css("max-height","756px").css("left",f-50),c(b).addClass("expand").addClass("static").siblings(".header-drop-wrapper").removeClass("expand static"),c(c(".header-drop-wrapper .drop-pannel")[d]).show(),c(".header-drop-wrapper .drop-pannel h4").addClass("show"),c(".header-drop-wrapper .drop-pannel .item-wrapper .item").addClass("show")},300)}else c(".header-line").css("width",0)},showSearch:function(){c(".header-drop-wrapper").hide(),c(".search-nav").addClass("searchBar-show"),c(".search-drop").css("max-height","1000px"),c(".search-drop").css("opacity",1),c(".search-nav input").focus(),h.getDefaultWord(),c(".gtn-header-box").addClass("hover"),h.searchBar=!0},closeSearch:function(){c(".search-nav").removeClass("searchBar-show"),c(".search-drop").css("max-height",0),c(".search-drop").css("opacity",0),c(".gtn-header-box").removeClass("hover"),h.searchBar=!1},getHotSearchWord:function(){d.ajax({url:"word/queryHotSearchWord.json",dataType:"json",type:"post",callback:function(a){if(a.list&&a.list.length>0)for(var b=0,c=a.list.length;b<c;b++)a.list[b].word_name_encode=encodeURIComponent(a.list[b].word_name);h.hotSearchList=a.list},failure:function(a){d.alertNodePop(a.error_info)}})},getDefaultWord:function(){d.ajax({url:"word/queryDefaultWord.json",dataType:"json",type:"post",callback:function(a){a&&a.word_name&&c(".searchBar-show .search-wrapper input").attr("placeholder",a.word_name)},failure:function(a){d.alertNodePop(a.error_info)}})},getLightAuthorize:function(){var a=d.isLogin();""!=a?h.getLightAuthInfo():h.login()},getLightAuthInfo:function(){d.ajax({url:"user/getLightAuthInfo.json",dataType:"json",type:"post",async:!1,callback:function(a){a&&a.url&&window.open(a.url)},failure:function(a){d.alertNodePop(a.error_info)}})}});c(function(){c("#search_tag a").click(function(){window.location.href="/result.html?content="+encodeURIComponent(c(this).text())})}),e(),c(function(){c(document).on("click",function(){c(".user_out").removeClass("user-open").addClass("user-close").find("div").removeClass("show_select").addClass("none_select")}),h.getHotSearchWord(),h.getDefaultWord()}),c(".gtn-header-box").mouseleave(function(a){c(".header-drop-wrapper").removeClass("expand").removeClass("static"),c(".header-drop-wrapper").css("height",0),c(".header-drop-wrapper").children().find("h4").removeClass("show"),c(".header-drop-wrapper").children().find(".item").removeClass("show"),h.searchBar||c(".gtn-header-box").removeClass("hover"),setTimeout(function(){c(".header-drop-wrapper").hide()},300)}),c(".gtn-header-box").mouseenter(function(a){c(".gtn-header-box").addClass("hover")}),c(".header-logo,.hr").mouseenter(function(a){c(".header-drop-wrapper").removeClass("expand").removeClass("static"),c(".header-drop-wrapper").css("height",0),c(".header-drop-wrapper").children().find("h4").removeClass("show"),c(".header-drop-wrapper").children().find(".item").removeClass("show"),setTimeout(function(){c(".header-drop-wrapper").hide()},300)}),b.scan()});