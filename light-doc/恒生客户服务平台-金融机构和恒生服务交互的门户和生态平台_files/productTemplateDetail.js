/*!2020-09-28 */
require(["domReady!","avalon","jquery","common/common","scrollspy","stickUp","pager","jquery.cookie","header","docSearch"],function(a,b,c,d,e,f){var g=b.define({$id:"productTemplateDetail",docMenuInfo:{},menuList:[],detailList:[],menuId:"",oldLevel:0,breadcrumbList:[],crumbList:[],htmlStr:"",faqDetailTitle:"",updateTime:"",view_num:"",isLogin:"",isContent:!!d.getUrlParam("faq_id"),firstLeafId:"",firstRendered:!0,getDetailing:!1,pager:{currentPage:1,totalItems:0,perPages:10,showJumper:!0,onJump:function(a,b){g.pager.currentPage=b.currentPage,g.$render()}},$render:function(){g.getFaqList()},init:function(){g.getMenu(),g.getLoginStatus()},getMenu:function(){var a=g.getQueryVariable("id");d.ajax({url:"productDoc/tree.json",dataType:"json",type:"post",data:{id:a},async:!1,callback:function(a){g.docMenuInfo=a[0],g.menuList=a[0].children}})},hide:function(){c("#docSearch").hide(),c("#docCons").show()},show:function(){c("#docSearch").show(),c("#docCons").hide()},tips:function(a,b){b=void 0==b?1e3:b,c.blockUI({message:'<div class="con-pop"><div class="inner"><div class="details"><p style="text-align: center">'+a+"</p></div></div></div>",timeout:b,overlayCSS:{opacity:.15,cursor:"default"},css:{left:"43%",position:"fixed",border:"0px",backgroundColor:"none",cursor:"auto",textAlign:"left"}})},getUrlParam:function(a){var b=new RegExp("(^|&)"+a+"=([^&]*)(&|$)"),c=window.location.search.substr(1).match(b);return null!=c?unescape(c[2]):null},getQueryVariable:function(a){for(var b=window.location.search.substring(1),c=b.split("&"),d=0;d<c.length;d++){var e=c[d].split("=");if(e[0]==a)return e[1]}return!1},escape2Html:function(a){var b={lt:"<",gt:">",nbsp:" ",amp:"&",quot:'"'};return a.replace(/&(lt|gt|nbsp|amp|quot);/gi,function(a,c){return b[c]})},add0:function(a){return a<10?"0"+a:a},timestampToTime:function(a){var b=new Date(a);return Y=b.getFullYear()+"-",M=(b.getMonth()+1<10?"0"+(b.getMonth()+1):b.getMonth()+1)+"-",D=b.getDate()+" ",h=b.getHours()+":",m=b.getMinutes()+":",s=b.getSeconds(),Y+M+g.add0(D)+g.add0(h)+g.add0(m)+g.add0(s)},getFaqDetail:function(a){g.getDetailing=!0,c.ajax({url:"/cloud/open/productDoc/detail.json",dataType:"json",data:{id:a},type:"post",success:function(a){if(a.success){var b=a.data.content;g.faqDetailTitle=a.data.title,g.updateTime=g.timestampToTime(a.data.update_time),g.view_num=a.data.view_num||0,c("#docCon").html(g.escape2Html(b)),prettyPrint(),g.loadScroller()}else"404291"==a.error_no?g.goLogin():tips(a.error_info,2e3);g.getDetailing=!1},error:function(a){g.getDetailing=!1}})},getFaqList:function(a){c(".faq-list-pannel").hide(),c(".loading").show(),c("#nodataDoc").hide();var b={pageSize:g.pager.perPages,currentPage:g.pager.currentPage,menu_id:g.menuId};d.ajax({url:"faq/list.json",dataType:"json",data:b,type:"post",callback:function(a){c(".loading").hide(),g.isContent=!1,g.detailList=a.list,a.list&&a.list.length>0?(c(".faq-list-pannel").show(),c("#nodataDoc").hide()):(c("#nodataDoc").show(),c(".faq-list-pannel").hide())}})},getLoginStatus:function(){d.ajax({url:"user/islogin.json",dataType:"json",type:"post",callback:function(a){g.isLogin=0!=a}})},goLogin:function(){c(".doc-warn-pop,.doc-black-sheild").show(),c("body").css("overflow","hidden")},handleLevelName:function(){g.crumbList=[];for(var a=c(".faqSidebar .active[clength!=0]>a"),b=0;b<a.length;b++)g.crumbList.push(c(a[b]).attr("title"))},menuListRendered:function(){c(".faq-list").hide();var a=d.getUrlParam("contId");a?g.initById(a):g.fundTreeDeeperId(g.menuList)},fundTreeDeeperId:function(a){1==a[0].is_leaf?g.initById(a[0].id):g.fundTreeDeeperId(a[0].children)},initById:function(a){var b=c("li[menuid="+a+"]").parents("li");g.initOpen("li[menuid="+a+"]"),c("li[menuid="+a+"]").addClass("active"),c("li[menuid="+a+"]").addClass("child-active");for(var d=0;d<b.length;d++){var e=c(b[d]).attr("menuid");g.initOpen("li[menuid="+e+"]")}g.handleLevelName()},loadScroller:function(){var a=c(".cont");a.length>0?(a.attr("offset","1"),c(".rside").html(""),c(".rside").append('<div id="sidebar_scroller" class="catListPostArchive sidebar-block" style="z-index: 99;"><ul class="nav"></ul></div>'),c("#sidebar_scroller").stickUp({currentMarginT:"0px"}),c(".cont :header").each(function(b){var d=c(this);if(d.attr("id","scroller-"+b),d[0].tagName>a[0].tagName)d.attr("offset",parseInt(a.attr("offset"))+1);else if(d[0].tagName<a[0].tagName){var e=parseInt(a.attr("offset"))-1;e<1&&(e=1),d.attr("offset",e)}else d.attr("offset",a.attr("offset"));var f=d.text().replace(/\s+/g,"");c("#sidebar_scroller ul").append('<li class="scroller-offset scroller-offset'+d.attr("offset")+'"><a title='+f+' href="#scroller-'+b+'">'+d.text()+"</a></li>"),a=d}),c("body").scrollspy(),0==c("#sidebar_scroller .active").length&&c("#sidebar_scroller li:first-child").addClass("active"),c("#sidebar_scroller a").on("click",function(){var a=c(this.hash).offset().top;return c("html, body").animate({scrollTop:a},800),!1})):c(".cont").append("")},initOpen:function(a){var b=c(a+" a").attr("title");g.oldLevel=c(a).attr("datalevel");var d=c(a).attr("menuid");0==c(a).attr("clength")&&(g.titleName1=b,g.getFaqDetail(d)),c(a).addClass("active"),c(a+">ul").show()},aClick:function(a){var b=c(a).parent("li");if(g.getDetailing)return void tips("页面获取中，请稍后……",2e3);var e=c(c(b).find("a")[0]).text(),f=c(b).attr("datalevel");g.oldLevel=f;var h=g.menuId=c(b).attr("menuid"),i=c(b).attr("clength");if(0==i&&(g.titleName1=e,g.getFaqDetail(h)),c(b).hasClass("active")?(c(a).siblings("ul").slideUp(300),c(b).removeClass("active"),c(b).find("li").removeClass("active"),c(b).find("ul").hide()):(c(b).siblings("li").find("ul").slideUp(300),c(b).siblings("li").find("ul").find("li").removeClass("active"),c(".faqSide .faqSidebar li").removeClass("child-active"),c(a).siblings("ul").slideDown(300),"0"===c(b).attr("clength")&&c(b).addClass("child-active"),c(b).siblings("li").removeClass("active"),c(b).addClass("active")),0==i){var j=d.getUrlParam("contId")?window.location.href.replace(/(contId=).*(?=)/,"contId="+g.menuId):window.location.href+"&contId="+g.menuId;history.replaceState({},"",j),g.handleLevelName()}}});jQuery(function(a){a(function(){g.init()})}),b.scan()});